import './polyfills.server.mjs';
import{C as n,Ra as u,c as i,cb as c,j as a,m as s}from"./chunk-23C7R4S6.mjs";var l=class r{constructor(t,e){this.router=t;this.platformId=e}USER_KEY="user_data";TOKEN_KEY="auth_token";isAuthenticatedSubject=new i(this.hasValidToken());currentUserSubject=new i(this.getCurrentUserFromStorage());isAuthenticated$=this.isAuthenticatedSubject.asObservable();currentUser$=this.currentUserSubject.asObservable();isBrowser(){return u(this.platformId)}hasValidToken(){if(this.isBrowser()){let t=localStorage.getItem(this.TOKEN_KEY),e=localStorage.getItem(this.USER_KEY);return!!(t&&e)}return!1}getCurrentUserFromStorage(){if(this.isBrowser()){let t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}return null}login(t,e){if(this.isBrowser()&&t&&e){let o={id:"1",name:"Demo User",email:t},h="demo-auth-token-"+Date.now();return localStorage.setItem(this.TOKEN_KEY,h),localStorage.setItem(this.USER_KEY,JSON.stringify(o)),this.isAuthenticatedSubject.next(!0),this.currentUserSubject.next(o),!0}return!1}logout(){this.isBrowser()&&(localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY)),this.isAuthenticatedSubject.next(!1),this.currentUserSubject.next(null),this.router.navigate(["/auth/login"])}getCurrentUser(){return this.currentUserSubject.value}isAuthenticated(){return this.isAuthenticatedSubject.value}checkAuthenticationStatus(){let t=this.hasValidToken(),e=this.getCurrentUserFromStorage();this.isAuthenticatedSubject.next(t),this.currentUserSubject.next(e)}static \u0275fac=function(e){return new(e||r)(s(c),s(n))};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
